<div class="text-center">
  <h1 class="title ">Your dashboard</h1>
</div>

<div class="container">
  <div class="row">
    <% @bookings.each do |booking| %>
      <div class="flip">
        <div class="col-xs-12 col-sm-6 col-md-4">
          <div class="card">
            <div class="face front">
              <div class="dashboard-card text-center">
                <div class="card-left" id="left-title">
                  <h2 class="heading-yellow"><%= booking.challenge.title%></h2>
                </div>
                <div class="card-left">
                  <div id="kisses">
                    <%= booking.challenge.category.kisses%> <%= image_tag "tiny_kiss.png" %>
                  </div>
                  <div id="booking-status">
                    <%= booking.status %>
                  </div>
                  <% if booking.status == "created" %>
                    <div class="col-xs-2">
                      <div id="confirm-challenge-button-<%= booking.id %>">
                        <%= link_to 'booking_validation', confirm_challenge_path(booking_id: booking.id), "data-toggle" => "modal", "data-target" => "#request-sent", remote: true, method: :post %>
                      </div>
                    </div>
                  <% elsif booking.status == "pending" %>
                    <button type="button", class="btn btn-success"> Waiting for partner </button>
                    <% else %>
                  <% end %>
                </div>
                <%= image_tag booking.challenge.category.picture, class: "dashboard-category"%>
              </div>
            </div>
            <div class="face back">
              <div class="dashboard-card text-center">
                <div class="card-left" id="left-title">
                  <h2 class="heading-yellow"><%= booking.challenge.title%></h2>
                </div>
                <%= booking.challenge.description %>
                <%= image_tag booking.challenge.category.picture, class: "dashboard-category"%>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>



<!-- modal -->
<div class="modal fade" id="request-sent" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content lovee-modal">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h3 class="modal-title text-center heading-blue">Confirmation request sent</h3>
      </div>
      <div class="modal-body text-center">
        <p>
        A confirmation request has been sent to your partner! You will get your LoVee kisses as soon as they confirm you completed this challenge.
        </p>
        <div class="modal-footer">
          <div class="text-center">
            <button type="button" class="btn button-lovee button-rules button-lovee-small" data-dismiss="modal">OK</button>
          </div>
        </div>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->




<% content_for :after_js do %>
  <%= javascript_tag do %>
  $(document).ready(function(){
    $('.flip').click(function(){
      $(this).find('.card').toggleClass('flipped');
    });
  });
  <% end %>
<% end %>

